close all
clear
clc

% g1 = [4.10357488
%     0.00009290
%      0.03378916
%       -0.08062592
%        0.06428052
%        0.05988973 
%         0.01698028
%         0.00001321
%         -0.00626774
%          -0.00003023
%     ];
% 
% g2 =[3.94661137
%      -0.00014585
%      0.05885548
%      0.04197538
%      0.05116130 
%       0.01794141
%       0.04403631
%        -0.00000302
%       0.00487831
%       -0.00004634
%     ];
% 
% g3 = [3.1701473
%     -0.00091345
%     -0.02955686
%      -0.08960531
%      0.05324242
%      0.04920979
%      0.01035803
%       4.152e-005
%       0.00353625
%      0.00041757 
%     ];
% 
% g4 = [2.735771
%     3.17e-006
%     -0.06745337
%     0.03425777
%     0.03282761
%     0.0093321 
%      0.02881095
%      -5.9e-007
%      -0.00348231
%      2.7e-007
%     ];
% 
% g5 = [ 1.690351
%      0.00012481
%      0.02138451
%       -0.14005421
%       0.04398029 
%        0.04183539
%        0.00522598
%         2.97e-006
%          -0.00198114
%          -3.035e-005
%     ];
% 
% g6 = [ 1.8062479
%      -2.6e-006
%      0.00060684
%      0.00031628
%      0.00488549  
%      0.00355788
%      0.00467648
%       8e-008
%        -0.0002422
%         1.4e-007
%     ];
% 
% 
% g7 = [0.30739653
%     6.11e-006
%     0
%         0.09733633
%         0.00313113
%         0.00312785
%         0.00033361
%          0
%          0
%          2.3e-007
%     ];


g1 = [4.10357488
    0.00009290
     0.03378916
      -0.08062592
    0.03291999
    0.03321425 
        0.01229516
        0.00000032
         0.00491156
        0.00000051
    ];

g2 =[3.94661137
     -0.00014585
     0.05885548
     0.04197538
0.03053671
0.01098766
0.03036529
0.00003086
 -0.00487172
  -0.00002218
    ];

g3 = [3.1701473
    -0.00091345
    -0.02955686
     -0.08960531
0.02501949
 0.02375368
 0.00758592
  -4.407e-005
   -0.00485973
    0.00015809
    ];

g4 = [2.735771
    3.17e-006
    -0.06745337
    0.03425777
 0.01716929
 0.00612142 
  0.01636331
   0  
   0.00283951
    -3e-008
    ];

g5 = [ 1.690351
     0.00012481
     0.02138451
      -0.14005421
0.01005075
0.00867883
0.00445296
-1.54e-006  
0.00308145
-8e-007
    ];

g6 = [ 1.8062479
     -2.6e-006
     0.00060684
     0.00031628
 0.00488464 
 0.0035577 
 0.00467582
 8e-008
  -0.00024254
   1.4e-007
    ];


g7 = [0.30739653
    6.11e-006
    0
        0.09733633
 0.00021874
  0.00021546
  0.00033361
  0
  0
  5e-008
    ];

g = [g1 g2 g3 g4 g5 g6 g7];

for i = 1:7
    L = [g(5,i)  g(8,i) -g(10,i);
         g(8,i) g(6,i) -g(9,i); 
         -g(10,i) -g(9,i) g(7,i)];

     p = [g(2,i) g(3,i) g(4,i)]';

    I = L + skew(p)*skew(p)'*g(1,i);
    
    g(5,i) = I(1,1);
    g(6,i) = I(2,2);
    g(7,i) = I(3,3);
    g(8,i) = I(1,2);
    g(9,i) = I(2,3);
    g(10,i) = I(1,3);
end

for i = 1:7
    g(2,i) = g(2,i)*g(1,i);
    g(3,i) = g(3,i)*g(1,i);
    g(4,i) = g(4,i)*g(1,i);
end

% m = [3.4525 3.4821 4.05623 3.4822 2.1633 2.3466 3.129];
% 
% for i = 1:7
%     g(:,i) = g(:,i)*m(i)/g(1,i);
% end
% 

phi = zeros(70,1);
for i = 1:7
    phi((i-1)*10+1:i*10,1) = g(:,i);
end

phi = phi';